<!DOCTYPE html>
<html>
<head>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="api.js"></script>
</head>
<body>
<iframe id="widget2" width="100%" src='http://w.soundcloud.com/player/?url=http://soundcloud.com/barehouse_1'>
</iframe>
<div id="changetrack">Change Track / URL to my account ;)</div>
<div id="result"></div>
</body>
<script src="http://connect.soundcloud.com/sdk-2.0.0.js"></script>
<script>
SC.initialize({
  client_id: '9423b887edb167141d82f7ab6f0cd34f'
});

// find all tracks with the genre 'punk' that have a tempo greater than 120 bpm.
SC.get('/tracks', { genres: 'punk', bpm: { from: 120 } }, function(tracks) {
  console.log(tracks);
});


var page_size = 200;
var bucket_size = 50000;
var bucket = 0;

// permalink to a track
var track_url = 'https://soundcloud.com/innervisions/essential-mix-september-2013';

SC.get('/resolve', { url: track_url }, function(track) {
  var numBuckets = Math.round(track.duration / bucket_size);
  var counterArray = [];
  for (i=0; i<numBuckets; i++) {
  	counterArray[i] = 0;
  }

  SC.get('/tracks/' + track.id + '/comments',{ limit: page_size }, function(comments) {
    for (var i = 0; i < comments.length; i++) {
        //$('#result').append(comments[i].timestamp + ': ' + comments[i].body + '<br/>');
        bucket = Math.round(comments[i].timestamp / bucket_size);
        counterArray[bucket]++;
    }

    console.log(counterArray);
  });

  
  
  /*
  SC.get('/tracks/' + track.id + '/comments',{ limit: page_size, offset: page_size}, function(comments) {
    for (var i = 0; i < comments.length; i++) {
    	//console.log(comments);
    	counter++;
     	$('#result').append(comments[i].timestamp + ': ' + comments[i].body + '<br/>');
      	console.log(counter);
    }
  });
  */ 

});

</script>
<script type="text/javascript">
(function() {
    var iframe2 = document.querySelector('#widget2');
    var widget2 = SC.Widget(iframe2);
    var newurl = 'http://soundcloud.com/bnzlovesyou';

    widget2.bind(SC.Widget.Events.READY, function() {
	    console.log('ready');
	    widget2.bind(SC.Widget.Events.PLAY, function(eventData) {
	        console.log('Playing..');
	    });
	    widget2.bind(SC.Widget.Events.PAUSE, function(eventData) {
	        console.log('PAUSE..');
	    });
	});

	$( "#changetrack" ).click(function() {
	 widget2.load(newurl);
	});    

}());
</script>


</html>